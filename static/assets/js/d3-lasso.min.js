!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("d3-selection"),require("d3-drag")):"function"==typeof define&&define.amd?define(["exports","d3-selection","d3-drag"],n):n(t.d3=t.d3||{},t.d3,t.d3)}(this,(function(t){"use strict";function n(t,n){return t(n={exports:{}},n.exports),n.exports}var r=n((function(t){t.exports=function(t,r,e){var o=t*r,a=n*t,s=a-(a-t),i=t-s,u=n*r,l=u-(u-r),f=r-l,c=i*f-(o-s*l-i*l-s*f);return e?(e[0]=c,e[1]=o,e):[c,o]};var n=+(Math.pow(2,27)+1)})),e=n((function(t){t.exports=function(t,n){var r=0|t.length,e=0|n.length;if(1===r&&1===e)return function(t,n){var r=t+n,e=r-t,o=t-(r-e)+(n-e);return o?[o,r]:[r]}(t[0],n[0]);var o,a,s=new Array(r+e),i=0,u=0,l=0,f=Math.abs,c=t[u],h=f(c),d=n[l],v=f(d);h<v?(a=c,(u+=1)<r&&(h=f(c=t[u]))):(a=d,(l+=1)<e&&(v=f(d=n[l]))),u<r&&h<v||l>=e?(o=c,(u+=1)<r&&(h=f(c=t[u]))):(o=d,(l+=1)<e&&(v=f(d=n[l])));for(var p,g,_=o+a,m=_-o,b=a-m,M=b,y=_;u<r&&l<e;)h<v?(o=c,(u+=1)<r&&(h=f(c=t[u]))):(o=d,(l+=1)<e&&(v=f(d=n[l]))),(b=(a=M)-(m=(_=o+a)-o))&&(s[i++]=b),M=y-((p=y+_)-(g=p-y))+(_-g),y=p;for(;u<r;)(b=(a=M)-(m=(_=(o=c)+a)-o))&&(s[i++]=b),M=y-((p=y+_)-(g=p-y))+(_-g),y=p,(u+=1)<r&&(c=t[u]);for(;l<e;)(b=(a=M)-(m=(_=(o=d)+a)-o))&&(s[i++]=b),M=y-((p=y+_)-(g=p-y))+(_-g),y=p,(l+=1)<e&&(d=n[l]);return M&&(s[i++]=M),y&&(s[i++]=y),i||(s[i++]=0),s.length=i,s}})),o=n((function(t){t.exports=function(t,n,r){var e=t+n,o=e-t,a=n-o,s=t-(e-o);return r?(r[0]=s+a,r[1]=e,r):[s+a,e]}})),a=n((function(t){var n=r,e=o;t.exports=function(t,r){var o=t.length;if(1===o){var a=n(t[0],r);return a[0]?a:[a[1]]}var s=new Array(2*o),i=[.1,.1],u=[.1,.1],l=0;n(t[0],r,i),i[0]&&(s[l++]=i[0]);for(var f=1;f<o;++f){n(t[f],r,u),e(i[1],u[0],i),i[0]&&(s[l++]=i[0]);var c=u[1],h=i[1],d=c+h,v=h-(d-c);i[1]=d,v&&(s[l++]=v)}return i[1]&&(s[l++]=i[1]),0===l&&(s[l++]=0),s.length=l,s}})),s=n((function(t){t.exports=function(t,n){var r=0|t.length,e=0|n.length;if(1===r&&1===e)return function(t,n){var r=t+n,e=r-t,o=t-(r-e)+(n-e);return o?[o,r]:[r]}(t[0],-n[0]);var o,a,s=new Array(r+e),i=0,u=0,l=0,f=Math.abs,c=t[u],h=f(c),d=-n[l],v=f(d);h<v?(a=c,(u+=1)<r&&(h=f(c=t[u]))):(a=d,(l+=1)<e&&(v=f(d=-n[l]))),u<r&&h<v||l>=e?(o=c,(u+=1)<r&&(h=f(c=t[u]))):(o=d,(l+=1)<e&&(v=f(d=-n[l])));for(var p,g,_=o+a,m=_-o,b=a-m,M=b,y=_;u<r&&l<e;)h<v?(o=c,(u+=1)<r&&(h=f(c=t[u]))):(o=d,(l+=1)<e&&(v=f(d=-n[l]))),(b=(a=M)-(m=(_=o+a)-o))&&(s[i++]=b),M=y-((p=y+_)-(g=p-y))+(_-g),y=p;for(;u<r;)(b=(a=M)-(m=(_=(o=c)+a)-o))&&(s[i++]=b),M=y-((p=y+_)-(g=p-y))+(_-g),y=p,(u+=1)<r&&(c=t[u]);for(;l<e;)(b=(a=M)-(m=(_=(o=d)+a)-o))&&(s[i++]=b),M=y-((p=y+_)-(g=p-y))+(_-g),y=p,(l+=1)<e&&(d=-n[l]);return M&&(s[i++]=M),y&&(s[i++]=y),i||(s[i++]=0),s.length=i,s}})),i=n((function(t){function n(t,n){for(var r=new Array(t.length-1),e=1;e<t.length;++e)for(var o=r[e-1]=new Array(t.length-1),a=0,s=0;a<t.length;++a)a!==n&&(o[s++]=t[e][a]);return r}function o(t){return 1&t?"-":""}function i(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var n=t.length>>1;return["sum(",i(t.slice(0,n)),",",i(t.slice(n)),")"].join("")}function u(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var r=[],e=0;e<t.length;++e)r.push(["scale(",i(u(n(t,e))),",",o(e),t[0][e],")"].join(""));return r}function l(t){for(var r=[],e=[],o=function(t){for(var n=new Array(t),r=0;r<t;++r){n[r]=new Array(t);for(var e=0;e<t;++e)n[r][e]=["m",e,"[",t-r-1,"]"].join("")}return n}(t),a=[],s=0;s<t;++s)0==(1&s)?r.push.apply(r,u(n(o,s))):e.push.apply(e,u(n(o,s))),a.push("m"+s);var l=i(r),f=i(e),p="orientation"+t+"Exact",g=["function ",p,"(",a.join(),"){var p=",l,",n=",f,",d=sub(p,n);return d[d.length-1];};return ",p].join("");return new Function("sum","prod","scale","sub",g)(h,c,d,v)}function f(t){var n=m[t.length];return n||(n=m[t.length]=l(t.length)),n.apply(void 0,t)}var c=r,h=e,d=a,v=s,p=5,g=l(3),_=l(4),m=[function(){return 0},function(){return 0},function(t,n){return n[0]-t[0]},function(t,n,r){var e,o=(t[1]-r[1])*(n[0]-r[0]),a=(t[0]-r[0])*(n[1]-r[1]),s=o-a;if(o>0){if(a<=0)return s;e=o+a}else{if(!(o<0))return s;if(a>=0)return s;e=-(o+a)}var i=33306690738754716e-32*e;return s>=i||s<=-i?s:g(t,n,r)},function(t,n,r,e){var o=t[0]-e[0],a=n[0]-e[0],s=r[0]-e[0],i=t[1]-e[1],u=n[1]-e[1],l=r[1]-e[1],f=t[2]-e[2],c=n[2]-e[2],h=r[2]-e[2],d=a*l,v=s*u,p=s*i,g=o*l,m=o*u,b=a*i,M=f*(d-v)+c*(p-g)+h*(m-b),y=7771561172376103e-31*((Math.abs(d)+Math.abs(v))*Math.abs(f)+(Math.abs(p)+Math.abs(g))*Math.abs(c)+(Math.abs(m)+Math.abs(b))*Math.abs(h));return M>y||-M>y?M:_(t,n,r,e)}];!function(){for(;m.length<=p;)m.push(l(m.length));for(var n=[],r=["slow"],e=0;e<=p;++e)n.push("a"+e),r.push("o"+e);var o=["function getOrientation(",n.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(e=2;e<=p;++e)o.push("case ",e,":return o",e,"(",n.slice(0,e).join(),");");o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),r.push(o.join(""));var a=Function.apply(void 0,r);for(t.exports=a.apply(void 0,[f].concat(m)),e=0;e<=p;++e)t.exports[e]=m[e]}()})),u=n((function(t){t.exports=function(t,r){for(var e=r[0],o=r[1],a=t.length,s=1,i=a,u=0,l=a-1;u<i;l=u++){var f=t[u],c=t[l],h=f[1],d=c[1];if(d<h){if(d<o&&o<h){if(0===(v=n(f,c,r)))return 0;s^=0<v|0}else if(o===h){if(h<t[(u+1)%a][1]){if(0===(v=n(f,c,r)))return 0;s^=0<v|0}}}else if(h<d){if(h<o&&o<d){if(0===(v=n(f,c,r)))return 0;s^=v<0|0}else if(o===h){if(t[(u+1)%a][1]<h){var v;if(0===(v=n(f,c,r)))return 0;s^=v<0|0}}}else if(o===h){var p=Math.min(f[0],c[0]),g=Math.max(f[0],c[0]);if(0===u){for(;l>0;){var _=(l+a-1)%a;if((M=t[_])[1]!==o)break;var m=M[0];p=Math.min(p,m),g=Math.max(g,m),l=_}if(0===l)return p<=e&&e<=g?0:1;i=l+1}for(var b=t[(l+a-1)%a][1];u+1<i;){var M;if((M=t[u+1])[1]!==o)break;m=M[0];p=Math.min(p,m),g=Math.max(g,m),u+=1}if(p<=e&&e<=g)return 0;e<p&&b<o!=t[(u+1)%a][1]<o&&(s^=1)}}return 2*s-1};var n=i}));t.lasso=function(){function t(t){var l,f,c,h,d=t.append("g").attr("class","lasso"),v=d.append("path").attr("class","drawn"),p=d.append("path").attr("class","loop_close"),g=d.append("circle").attr("class","origin"),_=d3.drag().on("start",(function(){h=[],l="",v.attr("d",null),p.attr("d",null),r.nodes().forEach((function(t){t.__lasso.possible=!1,t.__lasso.selected=!1,t.__lasso.hoverSelect=!1,t.__lasso.loopSelect=!1;var n=t.getBoundingClientRect();t.__lasso.lassoPoint=[Math.round(n.left+n.width/2),Math.round(n.top+n.height/2)]})),s&&r.on("mouseover.lasso",(function(){this.__lasso.hoverSelect=!0})),i.start()})).on("drag",(function(){var t,n;"touchmove"===d3.event.sourceEvent.type?(t=d3.event.sourceEvent.touches[0].clientX,n=d3.event.sourceEvent.touches[0].clientY):(t=d3.event.sourceEvent.clientX,n=d3.event.sourceEvent.clientY);var s=d3.mouse(this)[0],d=d3.mouse(this)[1];""===l?(l=l+"M "+s+" "+d,f=[t,n],c=[s,d],g.attr("cx",s).attr("cy",d).attr("r",7).attr("display",null)):l=l+" L "+s+" "+d,h.push([t,n]);var _=Math.sqrt(Math.pow(t-f[0],2)+Math.pow(n-f[1],2)),m="M "+s+" "+d+" L "+c[0]+" "+c[1];v.attr("d",l),p.attr("d",m),p.attr("display",(a=_<=e)&&o?null:"none"),r.nodes().forEach((function(t){t.__lasso.loopSelect=!(!a||!o)&&u(h,t.__lasso.lassoPoint)<1,t.__lasso.possible=t.__lasso.hoverSelect||t.__lasso.loopSelect})),i.draw()})).on("end",(function(){r.on("mouseover.lasso",null),r.nodes().forEach((function(t){t.__lasso.selected=t.__lasso.possible,t.__lasso.possible=!1})),v.attr("d",null),p.attr("d",null),g.attr("display","none"),i.end()}));n.call(_)}var n,r=[],e=75,o=!0,a=!1,s=!0,i={start:function(){},draw:function(){},end:function(){}};return t.items=function(n){if(!arguments.length)return r;var e=(r=n).nodes();return e.forEach((function(t){t.__lasso={possible:!1,selected:!1}})),t},t.possibleItems=function(){return r.filter((function(){return this.__lasso.possible}))},t.selectedItems=function(){return r.filter((function(){return this.__lasso.selected}))},t.notPossibleItems=function(){return r.filter((function(){return!this.__lasso.possible}))},t.notSelectedItems=function(){return r.filter((function(){return!this.__lasso.selected}))},t.closePathDistance=function(n){return arguments.length?(e=n,t):e},t.closePathSelect=function(n){return arguments.length?(o=!0===n,t):o},t.isPathClosed=function(n){return arguments.length?(a=!0===n,t):a},t.hoverSelect=function(n){return arguments.length?(s=!0===n,t):s},t.on=function(n,r){if(!arguments.length)return i;if(1===arguments.length)return i[n];var e=["start","draw","end"];return e.indexOf(n)>-1&&(i[n]=r),t},t.targetArea=function(r){return arguments.length?(n=r,t):n},t},Object.defineProperty(t,"__esModule",{value:!0})}));